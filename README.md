<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# cmd

```go
import "github.com/agent-collector/cmd"
```

## Index



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# config

```go
import "github.com/agent-collector/config"
```

## Index

- [type CPUCollectorConfig](<#CPUCollectorConfig>)
- [type CollectorConfig](<#CollectorConfig>)
  - [func \(col \*CollectorConfig\) Validate\(\) error](<#CollectorConfig.Validate>)
- [type Config](<#Config>)
  - [func Load\(configPath string\) \(\*Config, error\)](<#Load>)
  - [func \(c \*Config\) Validate\(\) error](<#Config.Validate>)
- [type HTTPServerConfig](<#HTTPServerConfig>)
  - [func \(h \*HTTPServerConfig\) Validate\(\) error](<#HTTPServerConfig.Validate>)
- [type ZapLogConfig](<#ZapLogConfig>)
  - [func \(l \*ZapLogConfig\) Validate\(\) error](<#ZapLogConfig.Validate>)


<a name="CPUCollectorConfig"></a>
## type CPUCollectorConfig

CPUCollectorConfig CPU采集器配置

```go
type CPUCollectorConfig struct {
    CPUCollectorConfig bool `yaml:"collect_per_core" mapstructure:"collect_per_core" env:"CPU_COLLECT_PER_CORE"`
}
```

<a name="CollectorConfig"></a>
## type CollectorConfig

CollectorConfig 采集器全局配置

```go
type CollectorConfig struct {
    Interval       time.Duration      `yaml:"interval" mapstructure:"interval" env:"COLLECT_INTERVAL"`
    EnableDisk     bool               `yaml:"enable_disk" mapstructure:"enable_disk" env:"ENABLE_DISK"`
    EnableNetwork  bool               `yaml:"enable_network" mapstructure:"enable_network" env:"ENABLE_NETWORK"`
    EnableCPU      bool               `yaml:"enable_cpu" mapstructure:"enable_cpu" env:"ENABLE_CPU"`
    IgnoreDisks    []string           `yaml:"ignore_disks" mapstructure:"ignore_disks"`
    IgnoreNetworks []string           `yaml:"ignore_networks" mapstructure:"ignore_networks"`
    CPU            CPUCollectorConfig `yaml:"cpu" mapstructure:"cpu"`
}
```

<a name="CollectorConfig.Validate"></a>
### func \(\*CollectorConfig\) Validate

```go
func (col *CollectorConfig) Validate() error
```



<a name="Config"></a>
## type Config

Config 全局配置结构体

```go
type Config struct {
    HTTP      HTTPServerConfig `yaml:"http"`
    Collector CollectorConfig  `yaml:"collector"`
    Log       ZapLogConfig     `yaml:"log"`
}
```

<a name="Load"></a>
### func Load

```go
func Load(configPath string) (*Config, error)
```

Load 加载配置 （优先级：命令行指定文件 \> 默认config.yaml \> 环境变量）

<a name="Config.Validate"></a>
### func \(\*Config\) Validate

```go
func (c *Config) Validate() error
```

Validate 配置校验

<a name="HTTPServerConfig"></a>
## type HTTPServerConfig

HTTPServerConfig HTTP服务配置

```go
type HTTPServerConfig struct {
    Addr string `yaml:"addr" mapstructure:"addr" env:"HTTP_ADDR"`
}
```

<a name="HTTPServerConfig.Validate"></a>
### func \(\*HTTPServerConfig\) Validate

```go
func (h *HTTPServerConfig) Validate() error
```

Validate HTTP服务配置校验

<a name="ZapLogConfig"></a>
## type ZapLogConfig

ZapLogConfig 全局日志配置

```go
type ZapLogConfig struct {
    Level  string `yaml:"level" mapstructure:"level" env:"LOG_LEVEL"`
    Format string `yaml:"format" mapstructure:"format"`
    Path   string `yaml:"path" mapstructure:"path"`
}
```

<a name="ZapLogConfig.Validate"></a>
### func \(\*ZapLogConfig\) Validate

```go
func (l *ZapLogConfig) Validate() error
```

Validate 日志配置校验

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# collector

```go
import "github.com/agent-collector/internal/collector"
```

## Index

- [type Agent](<#Agent>)
- [type CPUCollector](<#CPUCollector>)
  - [func NewCPUCollector\(cfg CPUCollectorConfig, metricFactory \*metrics.MetricFactory\) \*CPUCollector](<#NewCPUCollector>)
  - [func \(c \*CPUCollector\) Close\(\) error](<#CPUCollector.Close>)
  - [func \(c \*CPUCollector\) Collect\(ctx context.Context\) error](<#CPUCollector.Collect>)
  - [func \(c \*CPUCollector\) Init\(\) error](<#CPUCollector.Init>)
  - [func \(c \*CPUCollector\) Name\(\) string](<#CPUCollector.Name>)
- [type CPUCollectorConfig](<#CPUCollectorConfig>)
- [type CPUCollectorMetrics](<#CPUCollectorMetrics>)
- [type Collector](<#Collector>)
- [type DiskCollectorMetrics](<#DiskCollectorMetrics>)
- [type NetCollectorMetrics](<#NetCollectorMetrics>)
- [type Registry](<#Registry>)
  - [func NewRegistry\(interval time.Duration\) \*Registry](<#NewRegistry>)
  - [func \(r \*Registry\) CloseAll\(\) error](<#Registry.CloseAll>)
  - [func \(r \*Registry\) CollectAll\(ctx context.Context\) error](<#Registry.CollectAll>)
  - [func \(r \*Registry\) InitAll\(\) error](<#Registry.InitAll>)
  - [func \(r \*Registry\) Register\(c Collector\)](<#Registry.Register>)
  - [func \(r \*Registry\) Shutdown\(ctx context.Context\) error](<#Registry.Shutdown>)
  - [func \(r \*Registry\) Start\(ctx context.Context\)](<#Registry.Start>)


<a name="Agent"></a>
## type Agent

Agent 顶层采集器接口（封装所有采集器的生命周期管理） 后续扩展采集器仅需实现Collector接口，通过Agent注册即可

```go
type Agent interface {
    Register(collector Collector)       // 注册采集器
    Start(ctx context.Context)          // 启动采集（定时器循环）
    Shutdown(ctx context.Context) error // 优雅停止
}
```

<a name="CPUCollector"></a>
## type CPUCollector

CPUCollector CPU采集器（实现Collector接口）

```go
type CPUCollector struct {
    // contains filtered or unexported fields
}
```

<a name="NewCPUCollector"></a>
### func NewCPUCollector

```go
func NewCPUCollector(cfg CPUCollectorConfig, metricFactory *metrics.MetricFactory) *CPUCollector
```

NewCPUCollector 创建CPU采集器

<a name="CPUCollector.Close"></a>
### func \(\*CPUCollector\) Close

```go
func (c *CPUCollector) Close() error
```



<a name="CPUCollector.Collect"></a>
### func \(\*CPUCollector\) Collect

```go
func (c *CPUCollector) Collect(ctx context.Context) error
```



<a name="CPUCollector.Init"></a>
### func \(\*CPUCollector\) Init

```go
func (c *CPUCollector) Init() error
```



<a name="CPUCollector.Name"></a>
### func \(\*CPUCollector\) Name

```go
func (c *CPUCollector) Name() string
```

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\- 实现Collector接口 \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

<a name="CPUCollectorConfig"></a>
## type CPUCollectorConfig

CPUCollectorConfig CPU采集器配置

```go
type CPUCollectorConfig struct {
    CollectPerCore bool // 是否采集单核心使用率
}
```

<a name="CPUCollectorMetrics"></a>
## type CPUCollectorMetrics

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\- CPU采集器指标结构体 \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

```go
type CPUCollectorMetrics struct {
    // contains filtered or unexported fields
}
```

<a name="Collector"></a>
## type Collector

Collector 采集器核心接口（所有采集器必须实现）

```go
type Collector interface {
    Name() string                      // 采集器名称（唯一标识）
    Init() error                       // 初始化（注册指标、预检查资源）
    Collect(ctx context.Context) error // 采集数据（更新指标）
    Close() error                      // 关闭（释放资源）
}
```

<a name="DiskCollectorMetrics"></a>
## type DiskCollectorMetrics

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\- 磁盘采集器指标结构体 \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

```go
type DiskCollectorMetrics struct {
    // contains filtered or unexported fields
}
```

<a name="NetCollectorMetrics"></a>
## type NetCollectorMetrics

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\- 网络采集器指标结构体 \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

```go
type NetCollectorMetrics struct {
    // contains filtered or unexported fields
}
```

<a name="Registry"></a>
## type Registry

Registry 采集器注册器（实现Agent接口）

```go
type Registry struct {
    // contains filtered or unexported fields
}
```

<a name="NewRegistry"></a>
### func NewRegistry

```go
func NewRegistry(interval time.Duration) *Registry
```

NewRegistry 创建采集器注册器

<a name="Registry.CloseAll"></a>
### func \(\*Registry\) CloseAll

```go
func (r *Registry) CloseAll() error
```



<a name="Registry.CollectAll"></a>
### func \(\*Registry\) CollectAll

```go
func (r *Registry) CollectAll(ctx context.Context) error
```



<a name="Registry.InitAll"></a>
### func \(\*Registry\) InitAll

```go
func (r *Registry) InitAll() error
```

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\- 辅助方法 \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

<a name="Registry.Register"></a>
### func \(\*Registry\) Register

```go
func (r *Registry) Register(c Collector)
```

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\- 实现Agent接口 \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

<a name="Registry.Shutdown"></a>
### func \(\*Registry\) Shutdown

```go
func (r *Registry) Shutdown(ctx context.Context) error
```



<a name="Registry.Start"></a>
### func \(\*Registry\) Start

```go
func (r *Registry) Start(ctx context.Context)
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
